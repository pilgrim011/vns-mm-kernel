/******************************************************************************

                  版权所有 (C), 2001-2011, 华为技术有限公司

 ******************************************************************************
  文 件 名   : pppc_aes.h
  版 本 号   : 初稿
  作    者   :
  生成日期   : 2015年11月10日
  最近修改   :
  功能描述   : pppc_aes.c 的头文件
  函数列表   :
  修改历史   :
  1.日    期   : 2015年11月10日
    作    者   :
    修改内容   : 创建文件

******************************************************************************/

#ifndef __PPPC_AES_H__
#define __PPPC_AES_H__


/*****************************************************************************
  1 其他头文件包含
*****************************************************************************/
#include "PsCommonDef.h"



#ifdef __cplusplus
#if __cplusplus
extern "C" {
#endif
#endif

#pragma pack(4)

/*****************************************************************************
  2 宏定义
*****************************************************************************/

#define PPPC_AES_BLOCK_SIZE 16

#define GETU32(pt) (((VOS_UINT32)(pt)[0] << 24) ^ ((VOS_UINT32)(pt)[1] << 16) ^ \
((VOS_UINT32)(pt)[2] <<  8) ^ ((VOS_UINT32)(pt)[3]))
#define PUTU32(ct, st) { \
(ct)[0] = (VOS_UINT8)((st) >> 24); (ct)[1] = (VOS_UINT8)((st) >> 16); \
(ct)[2] = (VOS_UINT8)((st) >>  8); (ct)[3] = (VOS_UINT8)(st); }

#define PPPC_AES_PRIV_SIZE (4 * 4 * 15 + 4)
#define PPPC_AES_PRIV_NR_POS (4 * 15)

#define PPPC_TRANSFER_ENC(a, b, c, d)  (Te0[((a) >> 24) & 0xff] ^ Te1[((b) >> 16) & 0xff] ^ Te2[((c) >>  8) & 0xff] ^ Te3[(d) & 0xff])
#define PPPC_TRANSFER_DEC(a, b, c, d)  (Td0[((a) >> 24) & 0xff] ^ Td1[((b) >> 16) & 0xff] ^ Td2[((c) >>  8) & 0xff] ^ Td3[(d) & 0xff])


/*****************************************************************************
  3 枚举定义
*****************************************************************************/


/*****************************************************************************
  4 全局变量声明
*****************************************************************************/


/*****************************************************************************
  5 消息头定义
*****************************************************************************/


/*****************************************************************************
  6 消息定义
*****************************************************************************/


/*****************************************************************************
  7 STRUCT定义
*****************************************************************************/


/*****************************************************************************
  8 UNION定义
*****************************************************************************/


/*****************************************************************************
  9 OTHERS定义
*****************************************************************************/


/*****************************************************************************
  10 函数声明
*****************************************************************************/

VOS_UINT32 PPPC_AES_128_CBC_Decrypt
(
    VOS_UINT8                          *pucKey,
    VOS_UINT8                          *pucIv,
    VOS_UINT8                          *pucData,
    VOS_UINT32                          ulDataLen,
    VOS_UINT8                          *pucDst
);

VOS_UINT32 PPPC_AES_128_CBC_Encrypt
(
    VOS_UINT8                          *pucKey,
    VOS_UINT8                          *pucIv,
    VOS_UINT8                          *pucData,
    VOS_UINT32                          ulDataLen,
    VOS_UINT8                          *pucDst
);



#if (VOS_OS_VER == VOS_WIN32)
#pragma pack()
#else
#pragma pack(0)
#endif




#ifdef __cplusplus
    #if __cplusplus
        }
    #endif
#endif

#endif /* end of pppc_aes.h */

